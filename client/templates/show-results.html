{% load static %}
{% if jwt %}
        <div id="app">
            <div class="d-flex">
                <button class="btn btn-primary me-2" type="button" data-bs-toggle="collapse" data-bs-target="#jwt_signature"
                    aria-expanded="false" aria-controls="jwt_signature">
                    JWT Singature
                </button>
                <button class="btn btn-primary me-2" type="button" data-bs-toggle="collapse" data-bs-target="#jwt_auth"
                    aria-expanded="false" aria-controls="jwt_auth">
                    JWT Auth
                </button>
                <button class="btn btn-primary me-2" type="button" data-bs-toggle="collapse" data-bs-target="#headers"
                    aria-expanded="false" aria-controls="headers">
                    Headers
                </button>
            </div>
            <div>
                <div><strong>Http Status:</strong> {{response.status_code}}</div>
                <textarea readonly cols="80" rows="5">
                    {{response.text}}
                </textarea>

            </div>
            <div class="collapse" id="jwt_signature">
                <div><h2>JWT Signature:</h2></div>
                <div><h3>Headers</h3></div>
                <div v-for="(v, k) in jwt_data.header">
                <div><strong>[[k]]</strong></div>
                <div>[[v]]</div>
                </div>
                <div><h3>Payload</h3></div>
                <div v-for="(v, k) in jwt_data.payload">
                <div><strong>[[k]]</strong></div>
                <div>[[v]]</div>
                </div>
                <div><h3>Raw JWT Signature</h3></div>
                <textarea readonly cols="80" rows="20">
                {{jwt}}
                </textarea>
            </div>
            <div class="collapse" id="jwt_auth">
                <div><h2>JWT Auth:</h2></div>
                <div><h3>Headers</h3></div>
                <div v-for="(v, k) in jwt_auth_data.header">
                    <div><strong>[[k]]</strong></div>
                    <div>[[v]]</div>
                </div>
                <div><h3>Payload</h3></div>
                <div v-for="(v, k) in jwt_auth_data.payload">
                    <div><strong>[[k]]</strong></div>
                    <div>[[v]]</div>
                </div>
                <div><h3>Raw JWT Auth</h3></div>
                <textarea readonly cols="80" rows="20">
                {{jwt_auth}}
                </textarea>
            </div>
            <div class="collapse" id="headers">
                <strong>Headers:</strong>
                <textarea readonly cols="80" rows="20">
                {{response.request.headers}}
                </textarea>
            </div>
        </div>
        {%endif%}
  
{{jwt_data|json_script:"jwt_data"}}
{{jwt_auth_data|json_script:"jwt_auth_data"}}

<script src="{% static 'client/vue/vue.js' %}"></script>


<script>
  const { createApp } = Vue

  const app = createApp({
    data() {
      return {
        jwt_data: JSON.parse(document.getElementById('jwt_data').textContent),
        jwt_auth_data: JSON.parse(document.getElementById('jwt_auth_data').textContent)
      }
    }
  })
  app.config.compilerOptions.delimiters = ['[[', ']]']
  app.mount('#app')
</script>
